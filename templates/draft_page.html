
{% extends 'base.html' %}
{% block content %}

<script src="https://code.jquery.com/jquery.js"></script>
<script src="/static/save_draft.js"></script>
<script src="/static/publish_draft.js"></script>
<script src="/static/display_old_drafts.js"></script>


<!-- Check to see if in drafts; if not, save -->
<body>
{% if session.get('user_id') %} <!-- Query for draft in drafts -->
    <form action="/save_draft" method="POST" id="save_draft">
        <div>
            <label for="title_field"> Title </label>
            <input name="title" id="title_field" type="text" class="draft-control">
        </div>
        <div> 
            <label for="draft_field"> Draft </label>
            <input name="draft" id="draft_field" type="text" class="draft-control">
        </div>

        <!-- Save button -->
            <input id="save_btn" type="submit" name="Save">
    </form>
{% endif %}

{% if session.get('draft_id') %}
    <form action="/publish_draft" method="POST" id="publish_draft">
        <input type="hidden" id="publish_draft" value="{{ 'draft_id' }}">
        <input type="submit" id="publish_btn" value="Publish">
    </form>
{% endif %}


       
 <style>
 #previousDrafts {
    border: 1px solid black;
    margin-bottom: 10px;
 }
</style>
<p>List of previous drafts</p>
<div id="previousDrafts">
    Previous Drafts
</div>
{% if drafts %}
    {% for draft in drafts %}

    <a href="/draft_page/{{ draft.draft_id }}"><h2> {{ draft.title }}</h2></a>

    {% endfor %}

{% endif %}


<!-- "use strict";

    function showInputResults(result) {
        alert(result.draft_id);
        $('#previousDrafts').append('<a href=' + "/draft_page/" + result.draft_id + '>' + '<h2>' + result.draft_title + '</h2>' + '</a>')
    }

    function saveDraft(evt) {
        evt.preventDefault();
        console.log("hello");
        console.log($("#draft_field").val())
        console.log($("#title_field").val())

        var formInputs = {
            "title": $("#title_field").val(),
            "draft": $("#draft_field").val(),
        };
        console.log("hello");

        //make a post request - sending it to the route
        $.post("/save_draft",
                formInputs,

                showInputResults
                );
        console.log("hello");

    }

    $("#save_draft").on("submit", saveDraft);
 -->

</body>

{% endblock %}

